```git
git pull origin master
```

# 学习随笔

##### 1.@Controller与@RestController区别

@Controller是SpringMVC中常用的注解，可通过视图解析器执行页面跳转；@RestController是前后端分离时常用的注解，为@ResponseBody+@Controller两个注解相加，即在该Controller所有方法上都添加@ResponseBody注解，代表此Controller返回的都为json字符串，不可执行页面跳转。

若在Controller注解为@Controller，在某方法添加@ResponseBody注解，也可实现该方法返回json字符串。

@RestController后面不能直接跟路径

##### 2.SpringBoot注解@SpringBootApplication

包含三个注解

```java
@ComponentScan
/*这个注解是扫描本包及其子包下想让容器管理的类，即添加注解@Component，@Repository，@Service，@Controller的类，对应以前xml配置文件中的<context:component-scan>*/
@EnableAutoConfiguration
/*该注解的作用为启动自动的配置，就是根据jar包配置项目所需要的默认配置，如根据spring-boot-starter-web，会自动配置web项目所需的默认配置*/
@SpringBootConfiguration
/*该注解继承自@Configuration，功能也是相似的，即标注此类为配置类，且若此类中有添加@Bean的方法，则把返回值作为实例纳入到容器中管理，该实例名字为方法名*/
```

开启自动装配的就是@EnableAutoConfiguration。

##### 3.找到SpringBoot有哪些自动装配

@SpringBootApplication
-->
@EnableAutoConfiguration
-->
AutoConfigurationImportSelector.class
-->
getCandidateConfigurations()
-->
META-INF/spring.factories

##### 4.数据库连接池**HiKariCP**

<https://github.com/brettwooldridge/HikariCP>

优点：

1. 字节码精简：优化代码，直到编译后的字节码最少，这样，CPU缓存可以加载更多的程序代码；

  优化代理和拦截器：减少代码，例如HikariCP的Statement proxy只有100行代码，只有BoneCP的十分之一；

2. 自定义数组类型（FastStatementList）代替ArrayList：避免每次get()调用都要进行range check，避免调用remove()时的从头到尾的扫描；

3. 自定义集合类型（ConcurrentBag）：提高并发读写的效率；

4. 数据库连接中断处理：等待5秒钟后，如果连接还是没有恢复，则抛出一个SQLExceptions 异常；后续的getConnection()也是一样处理。

##### 5.数据源连接数

HiKariCP中默认最大最小都为10，生产中一般5（最小）—— 20（最大）。

##### 6.mybatis-generator生成问题

若以model形式存在时，需将配置文件**generatorConfig.xml**放在父项目根目录下，生成的pojo、mapper文件将会在父项目的src和resources中。

注：若不确定文件所放位置，可以用new File的形式创建一个文件，看看放在哪里。

##### 7.Propagation事务传播机制

- REQUIRED（默认）  使用当前的事务，如果没有事务，则新建一个事务，子方法必须运行在一个事务中；
  ​		  如果当前存在事务，则加入这个事务，成为一个整体。
  ​		  ex：领导没饭吃，我有钱，我买了自己吃；领导有饭吃，分给我一块吃。

- SUPPORTS  如果当前有事务，则使用事务；没有事务，则不使用事务。

  ​			 ex：领导有饭吃，分我一块吃；领导没饭吃，一块没饭吃。

- MANDATORY  该传播属性强制要求必须有一个事务，若没有则抛出异常。

  ​			    ex：领导必须管饭，若没饭，我就造反（抛出异常）。

- REQUIRES_NEW  如果当前有事务，则挂起事务，新建一个事务；
   ​		                 若没事务，则同REQUIRED；
     			           ex：领导有饭吃，我偏不吃，自己买着吃。

- NOT_SUPPORTED  如果有事务，则挂起事务，自己不使用事务去操作数据库。
   		​	   ex：领导有饭吃，我偏不吃，偏饿着。
- NEVER  如果当前有事务，则抛出异常。
   ​	   ex：领导有饭给你吃，我不吃，还要造反（抛出异常）。
- NESTED  如果有事务，则开启一个子事务（嵌套事务）。子事务独立提交或独立回滚。
   		如果没事务，则同REQUIRED。
      		如果主事务提交，则带上子事务一块提交。
      		如果主事务回滚，则带着子事务一块回滚。
      		如果子事务回滚，主事务可以选择回滚或者不回滚。
      		ex：领导决策不对，老板怪罪，领导带着小弟一块受罚；小弟犯错，老板怪罪，领导可以选择推卸责任或者一块受罚。

SpringBoot自动装配中默认开启了事务管理（@EnableTransactionManagement），以aop形式插入动态代理配置中。

##### 8.@RequestBody

​	此注解为Spring框架中对于请求参数的注解，放在方法中代表此请求参数为json字符串形式；

​	也可在Controller类上方加，代表此类每个方法请求参数都为json字符串形式。

##### 9.cookie和session

cookie:

- 在浏览器中以键值对的形式存储信息
- cookie不能跨域，当前以及父级域名可以取值
- cookie可以设置有效期
- cookie可以设置path

session：

- 基于服务器内存的缓存（非持久化），可保存请求对话
- 每个session通过sessionid来区分
- session可设置过期时间
- session以键值对形式存在

##### 10.AOP通知方式

- 前置通知：在方法调用之前执行
- 后置通知：在方法正常调用之后执行
- 环绕通知：在方法调用之前和之后，都分别可以执行的通知
- 异常通知：如果在方法调用过程中发生异常，则通知
- 最终通知：在方法调用之后执行

